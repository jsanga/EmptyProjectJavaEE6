<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/admin/principal.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core">
    

    <ui:define name="content">
        <h:form id="frmMain">
            <p:growl autoUpdate="true" showDetail="true" sticky="true"/>
            <p:commandButton value="Ingresar Profesor" update="dlgForm" icon="ui-icon-circle-arrow-e" actionListener="#{profesorView.nuevoProfesor()}" onclick="PF('dlgCrear').show()" style="margin-top: 15px; margin-bottom: 15px;"/>
            <center>
                <p:dataTable id="dtEstudiantesList" value="#{profesorView.profesores}" lazy="true" rows="5" paginator="true"
                             emptyMessage="No tiene datos" var="prof">
                    <f:facet name="header">
                        Lista de profesores
                    </f:facet>
                    <p:column headerText="Cédula" filterBy="#{prof.persona.cedula}">
                        <h:outputText value="#{prof.persona.cedula}" style="text-transform: uppercase;"/>
                    </p:column>
                    <p:column headerText="Nombres" filterBy="#{prof.persona.nombres}">
                        <h:outputText value="#{prof.persona.nombres}" style="text-transform: uppercase;"/>
                    </p:column>
                    <p:column headerText="Apellidos" filterBy="#{prof.persona.apellidos}">
                        <h:outputText value="#{prof.persona.apellidos}" style="text-transform: uppercase;"/>
                    </p:column>
                    <p:column headerText="Estado">
                        <h:outputText value="Activo" rendered="#{prof.persona.estado}" style="text-transform: uppercase;"/>
                        <h:outputText value="Inactivo" rendered="#{!prof.persona.estado}" style="text-transform: uppercase;"/>
                    </p:column>
                    <p:column headerText="Acción">
                        <center>                            
                            <p:commandButton value="Editar" actionListener="#{profesorView.editarProfesor(prof)}" onclick="PF('dlgEditar').show()" update="dlgFormEdit" icon="ui-icon-pencil"/>
                            <p:commandButton value="Eliminar" actionListener="#{profesorView.eliminarProfesor(prof)}" update="dtEstudiantesList" icon="ui-icon-circle-close"/>
                            <p:commandButton value="Más información" actionListener="#{profesorView.masInfo(prof)}" icon="ui-icon-zoomout"/>
                        </center>
                    </p:column>
                </p:dataTable>
            </center>
        </h:form>
        
        <p:dialog header="Ingresar Profesor" id="dlgCrear" widgetVar="dlgCrear" modal="true" height="auto" width="auto" resizable="false">  
            <h:form id="dlgForm" >
                <p:panelGrid columns="3" style="width: 100%;">
                    <h:outputText value="Cédula:"/>
                    <center><p:inputText value="#{profesorView.cedula}" style="text-transform: uppercase;"/></center>
                    <p:commandButton value="Buscar" actionListener="#{profesorView.buscarPersona()}" update="dtEstudiantes"/>
                </p:panelGrid>
                <p:dataTable id="dtEstudiantes" value="#{profesorView.personasEncontradasList}" emptyMessage="No tiene datos" style="width: 487px;" var="persona">
                    <p:column headerText="Nombres" >
                    <h:outputText value="#{persona.nombres}" style="text-transform: uppercase;"/>
                    </p:column>
                    <p:column headerText="Apellidos" >
                        <h:outputText value="#{persona.apellidos}" style="text-transform: uppercase;"/>
                    </p:column>
                    <p:column headerText="Estado">
                        <h:outputText value="Activo" rendered="#{persona.estado}" style="text-transform: uppercase;"/>
                        <h:outputText value="Inactivo" rendered="#{!persona.estado}" style="text-transform: uppercase;"/>
                    </p:column>
                    <p:column headerText="Rol">
                        <h:outputText value="#{persona.rol.rolName}" rendered="#{persona.rol!=null}" style="text-transform: uppercase;"/>
                        <h:outputText value="No tiene" rendered="#{persona.rol==null}" style="text-transform: uppercase;"/>
                    </p:column>
                    <p:column headerText="Acción">
                        <p:commandButton value="Seleccionar" disabled="#{!persona.estado}" update="dlgForm" actionListener="#{profesorView.ingresarProfesor(persona)}" style="text-transform: uppercase;" icon="ui-icon-carat-1-e"/>
                    </p:column>
                </p:dataTable>
                    
                <center><p:commandButton value="Salir" onclick="PF('dlgCrear').hide()" update=":frmMain"/></center>
            </h:form>
        </p:dialog>
        
        <p:dialog header="Editar Profesor" id="dlgEditar" widgetVar="dlgEditar" modal="true" height="auto" width="auto" resizable="false">  
            <h:form id="dlgFormEdit" >
                <p:panelGrid columns="2">
                    <h:outputText value="Nombres:"/>
                    <p:inputText value="#{profesorView.persona.nombres}" style="text-transform: uppercase;"/>
                    <h:outputText value="Apellidos:"/>
                    <p:inputText value="#{profesorView.persona.apellidos}" style="text-transform: uppercase;"/>
                    <h:outputText value="Dirección:"/>
                    <p:inputText value="#{profesorView.persona.direccion}" style="text-transform: uppercase;"/>
                    <h:outputText value="Fecha de Nacimiento:"/>
                    <p:calendar value="#{profesorView.persona.fechaNacimiento}" navigator="true"/>
                </p:panelGrid>
                
                <center><p:commandButton value="Terminar Edición" actionListener="#{profesorView.guardarEdicion()}" onclick="PF('dlgEditar').hide()" update=":frmMain" icon="ui-icon-check"/></center>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
